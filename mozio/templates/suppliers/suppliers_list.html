 {% extends "base.html" %}
{% load staticfiles %}c

 {% block content %}
    <div class="row">
      <div class="col-md-9">
          <div id="map" style="display: block; height: 500px;"></div>
      </div>
      <div class="col-md-3">
          <span id="result"></span>
      </div>
    </div>
 {% endblock %}


{% block javascript %}
    {{ block.super }}
    <script src="http://maps.google.com/maps/api/js"></script>
    <script src="{% static 'js/gmaps.min.js' %}"></script>
    <script>
        var map;
        var polygons = []
        $(document).ready(function() {
            map = new GMaps({
                el: '#map',
                lat: 3.451647,
                lng: -76.531985,
                zoom: 14,
                click: function(e){
                    for(var i = 0; i < polygons.length; i++) {
                        var result = google.maps.geometry.poly.containsLocation(e.latLng, polygons[i]);
                        if (result) {
                            $('#result').html('This point is inside a Service Area');
                            break;
                        }
                        else {
                            $('#result').html('This point is outside of a Service Area');
                        }
                    }
                }

            });
            {% for element in object_list %}
                var coords = {{ element.area.geojson|safe }};
                var polygon =  map.drawPolygon({
                    paths: coords.coordinates,
                    useGeoJSON: true,
                    visible: false,
                    clickable: true,
                    fillOpacity: 0
                  });
                polygons.push(polygon);
            {% endfor %}
        })
    </script>


{% endblock %}
